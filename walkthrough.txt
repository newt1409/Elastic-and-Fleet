docker run --name temp_elastic -it docker.elastic.co/elasticsearch/elasticsearch:7.16.3 /bin/bash
	bin/elasticsearch-certutil ca
		<enter> #no password
		<enter>
	bin/elasticsearch-certutil cert --ca elastic-stack-ca.p12
		<enter> #no password
		<enter>
		<enter> #no password
	bin/elasticsearch-certutil http
		<n>
		<y>
		</usr/share/elasticsearch/elastic-stack-ca.p12>
		<enter> #no password
		<5y>
		<n>
		<*.windomain.local>
		<y>
		<127.0.0.1>
		<0.0.0.0>
		<10.0.0.191>
		<y>
		<n>
		<enter> #no password
		<enter>
docker cp temp_elastic:/usr/share/elasticsearch/elastic-certificates.p12 ./elasticsearch/certs/.
docker cp temp_elastic:/usr/share/elasticsearch/elastic-stack-ca.p12 ./elasticsearch/certs/.
docker cp temp_elastic:/usr/share/elasticsearch/elasticsearch-ssl-http.zip ./elasticsearch/certs/.
unzip ./elasticsearch/certs/elasticsearch-ssl-http.zip
mv ./elasticsearch/certs/elasticsearch/http.p12 ./elasticsearch/certs/
sudo echo "vm.max_map_count=262144" >> /etc/sysctl.conf
sudo sysctl -p
sudo nano /etc/hosts
	127.0.0.1 elasticsearch
	127.0.0.1 elasticsearch1
	127.0.0.1 elasticsearch2
	127.0.0.1 kibana
docker-compose up -d
<lowered memory to 1gb for elastic nodes> #caused instability due to max memory


elasticsearch-setup-passwords interactive
	elastic
		password
		password
	apm_system
		password
		password
	kibana_system
		password
		password
	logstach_system
		password
		password
	beats_system
		password
		password
	remote_monitoring_user
		


openssl x509 -signkey kibana-server.key -in kibana-server.csr -req -days 1825 -out kibana-server.crt

cp ./kibana/elasticsearch-ca.pem fleet/.
cp kibana/kibana-server.* fleet/.

add integration -> fleet -> <no changes> save and continue
add agent -> default policy -> quick start -> https://localhost:8220
edit fleet docker-compose
	changed service token
	changed FLEET_URL=https://localhost:8220
	changed FLEET_SERVER_ELASTICSEARCH_HOST=https://localhost:9200
	
	
	
	
	
	

